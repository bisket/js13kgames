<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
    <style media="screen"> /* 여기서부터 CSS */
      @media(){ /*디바이스 크기따라 캔버스 크기 조절*/
        canvas{

        }
      }
      *{
        border: 1px solid gray; /*캔버스 크기 파악*/
        margin: auto;
      }
      canvas{
        display: block;
      }
    </style>
  </head>
  <body onload = "start()">
    <canvas id="C" width="800" height="500"></canvas>
    <script type="text/javascript"> // 여기서부터 자바스크립트

      let c = document.getElementById('C')
      let ctx = c.getContext("2d")
      let rightMove, leftMove, lastJump = 0, damaged, jump
      window.addEventListener('keydown', function(e){
        if(e.keyCode == 68){rightMove = true} // D키를 누르면 오른쪽으로 이동
        else if(e.keyCode == 65){leftMove = true} // A키를 누르면 왼쪽으로 이동
        else if(e.keyCode == 32){jump = true} // 스페이스바를 누르면 점프
      })
      window.addEventListener('keyup', function(e){
        if(e.keyCode == 68){rightMove = false}
        else if(e.keyCode == 65){leftMove = false}
      })

      // 캐릭터 만들기
      let pc = {
        i: 0,
        x: 300,
        y: 250,
        gravity: 5,
        jump: function(){
            if(this.i<25){
              this.y -= this.gravity;
              this.i++
            }
            else if(this.i<50){
              this.y += this.gravity;
              this.i++
            }
            else if(this.i == 50){
              lastJump=50
              this.i=0
              jump = false;
            }
        },
        move: function(){
          if(rightMove){this.x += 5}
          else if(leftMove){this.x -= 5; rightMove = false}
          if(jump&&lastJump>50){this.jump()}
          else if(jump){jump=false}
        },
        pos: function(){
          let a = rightMove ? 'right' : leftMove ? 'left' : 'stop'
          return a
        },
        drawing: function(pos){
          this.move()
          ctx.fillStyle = 'PeachPuff';
          ctx.fillRect(this.x, this.y, 60, 40)
          ctx.fillStyle = 'purple'
          ctx.fillRect(this.x+10, this.y+20, 5, 10)
          ctx.fillRect(this.x+40, this.y+20, 5, 10)
          ctx.fillRect(this.x, this.y, 20, 15)
          ctx.fillRect(this.x, this.y, 60, 10)
          ctx.fillRect(this.x+25, this.y, 20, 15)
          ctx.fillRect(this.x+50, this.y, 10, 15)
          ctx.fillStyle = '#404040'
          ctx.fillRect(this.x, this.y+40, 60, 25)
          ctx.fillStyle = 'aliceBlue'
          ctx.fillRect(this.x, this.y+65, 60, 15)
          if(pos == 'stop'){
            ctx.fillStyle = 'purple'
            ctx.fillRect(this.x+60, this.y-10, 15, 50)
            ctx.fillRect(this.x+60, this.y+40, 20, 15)
            ctx.fillRect(this.x, this.y+15, 5, 23)
            ctx.fillRect(this.x-5, this.y+35, 5, 10)
            ctx.fillRect(this.x+55, this.y+15, 5, 23)
            ctx.fillStyle = 'red'
            ctx.fillRect(this.x+60, this.y, 10, 20)
            ctx.fillRect(this.x+40, this.y-10, 20, 10)
          }
          else if(pos == 'left'){
            ctx.fillStyle = 'purple'
            ctx.fillRect(this.x+60, this.y-10, 15, 50)
            ctx.fillRect(this.x+60, this.y+40, 20, 15)
            ctx.fillRect(this.x+40, this.y, 20, 40)
            ctx.fillStyle = 'PeachPuff'
            ctx.fillRect(this.x+40, this.y+20, 5, 10)
            ctx.fillStyle = 'red'
            ctx.fillRect(this.x+60, this.y, 10, 20)
            ctx.fillRect(this.x+40, this.y-10, 20, 10)
          }
          else if(pos == 'right'){
            ctx.fillStyle = 'purple'
            ctx.fillRect(this.x-15, this.y-10, 15, 50)
            ctx.fillRect(this.x-20, this.y+40, 20, 15)
            ctx.fillRect(this.x, this.y, 20, 40)
            ctx.fillStyle = 'PeachPuff'
            ctx.fillRect(this.x+15, this.y+20, 5, 10)
            ctx.fillStyle = 'red'
            ctx.fillRect(this.x-10, this.y, 10, 20)
            ctx.fillRect(this.x, this.y-10, 20, 10)
          }
          if(damaged){
            ctx.fillRect(this.x, this.y, 60, 80);
          }
        }
      }

      // 미니맵 만들기
      let map = {
        drawing: function(){
          ctx.fillRect(0, 0, 150, 100)
        }
      }

      //퀘스트창 만들기
      let quest = {
        x: 200,
        drawing: function(){
          ctx.fillRect(c.width-this.x, 0, this.x, 100)
        }
      }

      let myPage = {
        y: 100,

        //가방 만들기
        myBag: {
          drawing: function(){
            ctx.fillStyle = 'tomato'
            ctx.fillRect(0, c.height-100, 120, 100/3)
          }
        },

        //스테이터스 만들기 (램프 시간 표시)
        myStat: {
          drawing: function(){
            let y = (100/3)*2
            ctx.fillStyle = 'salmon'
            ctx.fillRect(0, c.height-y, 120, 100/3)
          }
        },

        //기타 등등.
        etc: {
          drawing: function(){
            let y = (100/3)
            ctx.fillStyle = 'pink'
            ctx.fillRect(0, c.height-y, 120, 100/3)
          }
        },

        // 3단 그라데이션
        drawing: function(){
          ctx.fillRect(0, c.height-this.y, 120, this.y)
          this.myBag.drawing()
          this.myStat.drawing()
          this.etc.drawing()
        }
      }

      //채팅 표시 만들기
      let chat = {
        x: 680,
        y: 100,
        drawing: function(){
          ctx.fillStyle = 'lightgray'
          ctx.fillRect(c.width-this.x, c.height-this.y, this.x, this.y)
        }
      }

      //배경 만들기
      let background = {
        drawing: function(){
          ctx.fillStyle = 'Chocolate '
          ctx.fillRect(0, 0, c.width, c.height)
        }
      }

      //게임을 처음 시작할 때 설정
      function start(){
        setInterval(update, 20)
      }

      //캔버스 전체 지우고 다시 그릴 때 설정
      function update(){
        ctx.clearRect(0, 0, c.width, c.height)
        background.drawing()
        pc.drawing(pc.pos());
        map.drawing();
        quest.drawing();
        myPage.drawing();
        chat.drawing();
        lastJump += 1
      }
    </script>
  </body>
</html>
